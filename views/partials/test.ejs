<!DOCTYPE html>
<html lang="en">
<%- include('./header.ejs') %>


<style>
  .hover:hover{
    color: cadetblue
  }
  .hover{
    color: white;
  }
</style>

<body style="font-family: 'Inclusive Sans', sans-serif; background-color: #343541;" >

  
  <nav class="navbar fixed-top navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">Kadmin.Online</a>
    </div>
  </nav>
  
  <div class="container-fluid p-0 h-100">
    
    


    <div class="row   position-sticky w-100" style="margin-top: 56px; height: 100%;" >
        <div class="col-2  bg-black">
          <div class="d-flex p-2">
            <p class="  m-auto  hover" type="button" hx-get="/testdash"  hx-trigger="click"  hx-target="#output" hx-boost="{ preload: true }" >
              <i class="fa-solid fa-gauge"></i>  Dashboard

              </p>

            
          </div>          
          <!-- <div class="d-flex p-2">
            <p class=" hover m-auto" type="button" hx-get="/testapps" hx-trigger="click" onclick="toggle('apps')" hx-target="#apps">
              <i class="fa-solid fa-terminal"></i>  Terminal
              </p>
          </div>           -->
          <div class="d-flex p-2">
            <p class="hover m-auto" type="button"  hx-get="/testapps" hx-trigger="click" hx-target="#output"  hx-boost="{ preload: true }">
              <i class="fa-solid fa-paper-plane"></i> Applications 
          </p>


              
              
          </div>
          <div class="d-flex p-2">
            <p class=" hover m-auto" type="button" hx-get="/testfolders" hx-trigger="click"  hx-target="#output">
              <i class="fa-solid fa-folder"></i>  Folders
              </p>
          </div>

          
           

           
        </div>
        
        <div class="col-10 " id="output" style="height: 92.56vh;  overflow-y: auto;" >

          
        </div>
        
        
        
        <div id="log" class="">

        </div>
    </div>
  </div>
</body>





<script>
   var user = "<%= server %>"
     function executeCommand(command , out) {
            // var command = document.getElementById("command").value;
             // Replace with the actual username

            var xhr = new XMLHttpRequest();
            xhr.open("POST", "https://kapi.kadmin.online/execute/" + user, true);
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

            xhr.onreadystatechange = function () {
                if (xhr.readyState == 4 && xhr.status == 200) {
                    document.getElementById(out).innerText = xhr.responseText;
                }
            };

            xhr.send("command=" + encodeURIComponent(command));
        }


        async function execute(command) {
          return new Promise((resolve, reject) => {
              var xhr = new XMLHttpRequest();

              xhr.open("POST", "https://kapi.kadmin.online/execute/" + user, true);
              xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");

              xhr.onreadystatechange = function () {
                  if (xhr.readyState == 4) {
                      if (xhr.status == 200) {
                          
                          resolve(xhr.responseText);
                      } else {
                          reject(new Error(`Request failed with status: ${xhr.status}`));
                      }
                  }
              };

              xhr.send("command=" + encodeURIComponent(command));
          });
}


</script>






<script>

  document.querySelectorAll('.hover').forEach(function(button) {

    var originalButtonContents = button.innerHTML;

    button.addEventListener('click', function () {

      button.innerHTML = '<i class="fas fa-spinner fa-spin "></i>';


      htmx.on('htmx:afterRequest', function (event) {
        if (event.detail.elt.id === button.id) {
          // Replace with the original innerHTML after loading
          button.innerHTML = originalButtonContents
        }
      });
    });
  });
</script>




</html>