<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Code Editor</title>
  <script src="https://unpkg.com/monaco-editor@0.30.1/min/vs/loader.js"></script>
</head>
<body>
    
  <div id="editor" style="width: 800px; height: 600px;"></div>
  <button id="saveButton">Save</button>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/he/1.2.0/he.min.js" integrity="sha512-PEsccDx9jqX6Dh4wZDCnWMaIO3gAaU0j46W//sSqQhUQxky6/eHZyeB3NrXD2xsyugAKd4KPiDANkcuoEa2JuA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor@0.30.1/min/vs' }});
    

    var std = he.decode(`<%= std.replace(/\n/g, "\\n") %>`);

    require(['vs/editor/editor.main'], function () {
      var editor = monaco.editor.create(document.getElementById('editor'), {
        value: '',
        language: 'plaintext'
      });

      // Log the std content
      console.log(std);

      // Set the std content in the editor
      editor.setValue(std);

      // Function to save the file
      function saveFile(filePath, content) {
        fetch('/readfile/save-file', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ filePath, content })
        })
          .then(response => response.json())
          .then(data => {
            console.log(data.message);
          })
          .catch(error => {
            console.error('Error saving file:', error);
          });
      }
      
      // Example: Load and edit a file

      // Save button click event
      document.getElementById('saveButton').addEventListener('click', function () {
        var editedContent = editor.getValue();
        saveFile('/root/test.js', editedContent);
      });
    });
  </script>
</body>
</html>
