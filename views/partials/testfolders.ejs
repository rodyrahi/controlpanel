


<script src="https://unpkg.com/monaco-editor@0.30.1/min/vs/loader.js"></script>


<div class="input-group flex-nowrap mx-2 my-1 sticky-top ">
  <!-- <input type="text" class="form-control" placeholder="Username" > -->
  <input type="text" class="form-control" id="filterInput" placeholder="Type to Search" aria-label="Username" aria-describedby="addon-wrapping">
  <span class="input-group-text" id="addon-wrapping"> <i class="fa-solid fa-magnifying-glass m-auto  " style="font-size: 1.5rem; color: rgb(42, 97, 99);"></i> </span>

</div>
<hr>
<div class="row" >





<div class=" col-2 p-3 " id="explorer" style="height: 80vh;  overflow-y: auto;" >
    <% folders.forEach((element , index) => { %>
        <% if (index >2) { %>
            <% let parts = element.split(" "); %>
            <% let name = parts[parts.length - 1]; %>
            <p onclick="cd(this)" type="button" data-type="<%= parts[0].includes("d") ? "dic" : "file"  %>"   class="text-light " ><%= name %>
                
            </p>
        <% } %>
     
    <% }) %>
</div>

<div class="col-10">
  <div id="editor" style="height: 75vh;"></div>

</div>


</div>
  



<textarea  hx-post="/testchangedic" hx-trigger="click" hx-target="#output" name="command" id="changedir" style="display: none;" ></textarea>

<script>
let dir = '';

async function cd(el) {
    const type = el.getAttribute('data-type');

    if (type === "dic") {
        const currentDir = el.innerHTML.trim();
        dir += currentDir + '/';

        const command = `cd ${dir}\nls -la`;
        console.log(command);
        console.log(dir);

        document.getElementById('changedir').innerHTML = command;
        document.getElementById('changedir').click();
    }else{
      const data = await execute(`cat ${dir+el.innerHTML.trim()}` )
      require.config({ paths: { 'vs': 'https://unpkg.com/monaco-editor@0.30.1/min/vs' }});


      var name = el.innerHTML
      el.innerHTML = '<i class="fas fa-spinner fa-spin "></i>'
      require(['vs/editor/editor.main'], function () {
        document.getElementById('editor').innerHTML = ''
        var editor = monaco.editor.create(document.getElementById('editor'), {
          value: '',
          language: 'plaintext'
        })

        editor.setValue(data);
        el.innerHTML = name

      });

    }
}

</script>



<script>
    document.getElementById('filterInput').addEventListener('input', function() {
      var filterValue = this.value.toLowerCase(); // Get the value entered by the user and convert it to lowercase for case-insensitive filtering
      var itemList = document.getElementById('explorer');
      var items = itemList.getElementsByTagName('p');
  
      Array.from(items).forEach(function(item) {
        var text = item.textContent.toLowerCase();
        if (text.indexOf(filterValue) > -1) {
          item.style.display = 'block'; // Show the item if the text matches the filter
        } else {
          item.style.display = 'none'; // Hide the item if the text does not match the filter
        }
      });
    });
</script>


